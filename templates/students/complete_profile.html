<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Complete Your Profile</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { 
      display: flex; 
      flex-direction: column; 
      min-height: 100vh; 
      background-color: #f8f9fa; 
    }
    main { flex: 1; }
    .card { 
      max-width: 700px; 
      margin: auto; 
      border-radius: 12px; 
    }
    .form-label { font-weight: 500; }
  </style>
</head>
<body>

<main class="container my-5">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show text-center fw-bold py-2 mb-3" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <div class="card shadow-sm p-4">
    <h2 class="text-center mb-4">Complete Your Profile</h2>
    <form action="{{ url_for('complete_profile') }}" method="POST">
      <!-- Row 1: Full Name + Phone -->
      <div class="row mb-3">
        <div class="col-md-6 mb-3">
          <label for="full_name" class="form-label">Full Name</label>
          <input type="text" id="full_name" name="full_name" class="form-control" required value="{{ existing_profile.full_name if existing_profile else '' }}">
        </div>
        <div class="col-md-6 mb-3">
          <label for="phone_number" class="form-label">Contact Number</label>
          <input type="text" id="phone_number" name="phone_number" class="form-control" required value="{{ existing_profile.phone_number if existing_profile else '' }}">
        </div>
      </div>

      <!-- Row 2: Course + Level + Admission Number -->
      <div class="row mb-3">
        <div class="col-md-4 mb-3">
          <label for="course" class="form-label">Course</label>
          <select id="course" name="course_id" class="form-select" required>
            <option value="">-- Select Course --</option>
            {% for course in courses %}
              <option value="{{ course.id }}" {% if existing_profile and course.id == existing_profile.course_id %}selected{% endif %}>{{ course.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-4 mb-3">
          <label for="level" class="form-label">Level</label>
          <select id="level" name="level" class="form-select" required>
            <option value="">-- Select Level --</option>
            {% for level in levels %}
              <option value="{{ level }}" {% if existing_profile and level == existing_profile.level %}selected{% endif %}>{{ level }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-4 mb-3">
          <label for="admission_number" class="form-label">Admission Number</label>
          <input type="text" id="admission_number" name="admission_number" class="form-control" required value="{{ existing_profile.admission_number if existing_profile else '' }}">
        </div>
      </div>

      <!-- Row 3: Exam Type -->
      <div class="row mb-3">
        <div class="col-md-6 mb-3">
          <label for="exam_type" class="form-label">Exam Type</label>
          <select id="exam_type" name="exam_type" class="form-select" required>
            <option value="">-- Select Exam Type --</option>
            {% for option in ['kasneb', 'knec', 'nita', 'short_course'] %}
              <option value="{{ option }}" {% if existing_profile and existing_profile.exam_type == option %}selected{% endif %}>{{ option.upper() }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <button type="submit" class="btn btn-success w-100 mt-4">Complete Profile</button>
    </form>
  </div>
</main>

<footer class="bg-dark text-white text-center py-3">
  &copy; {{ current_year }} Summit Technical College. All rights reserved.
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // Auto dismiss flash messages after 4 seconds
  setTimeout(function() {
    let alerts = document.querySelectorAll('.alert');
    alerts.forEach(function(alert) {
      let bsAlert = new bootstrap.Alert(alert);
      bsAlert.close();
    });
  }, 4000); // 4000ms = 4 seconds
</script>
</body>
</html>
